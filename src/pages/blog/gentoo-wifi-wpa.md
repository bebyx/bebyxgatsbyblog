---
title: "Як під'єднати Gentoo Linux до Wifi"
date: "2020-03-30"
description: "Wifi і мінімалістична Gentoo Linux - нерозлучні друзі, якщо все правильно налаштувати. А налаштувати просто - дивіться як."
tags: ["Gentoo", "Linux"]
---

Якщо встановлюєте мінімалістичну систему з Gentoo, то вам конче треба вміти під'єднатися до Інтернету, і то радше всього по Wifi - 2к20 надворі.

Я мав трохи мороки з тим, бо інфа по вайфаю розкидана по вікі Gentoo в різних місцях, і я початково припустився деяких хиб, налаштовуючи ядра та запускаючи бездротову мережу.

Все виправив, усе працює. І отримав гарний досвід, яким хочу поділитися, склавши короткий ґайд з усіх необхідних кроків, що їх я зробив.

Ґайд, який, гадаю, згодиться для будь-якого домашнього лаптопа з Gentoo.

Поїхали.

## Під'єднатися до Wifi під встановлення Gentoo

Під час інсталяції, а це третій етап Посібника Ґенту, під'єднатися до Інтернета по вайфаю доволі просто.

Система LiveCD сама підшукує потрібні для вашої карти бездротового під'єднання до мережі драйвери, а до того містить у собі всі потрібні й непотрібні мережеві інструменти (деякі з котрих - потрібні - ми згодом скачаємо для нашої свіжої системи).

Я встановлював Gentoo з мінімального CD (який можна скачати тут https://www.gentoo.org/downloads/) - і під'єднатися до домашнього Wifi стало два рядки в терміналі:

```bash
wpa_passphrase ssid password > /etc/wpa_supplicant/wpa_supplicant.conf
wpa_supplicant -B -i wlp5s0 -c /etc/wpa_supplicant/wpa_supplicant.conf
```
Де **ssid** - назва вашої вайфай-мережі (напр., *tolyan286*), **password** - пароль до вайфаю, а **wlp5s0** - назва мережевого інтерфейсу бездротової мережевої карти (у вас він може називатися інакше, напр. ***wlan0***, ***wlp2s0*** тощо, введіть у термінал `ifconfig` і подивіться).

Готово. Можете глянути *ifconfig*, де в даних бездротового мережевого інтерфейсу має показатися IP-адреса, і пінганути якийсь сайт, наприклад:

`ping bebyx.co.ua`

Якщо видає рядками щось на кшталт `64 bytes from bla-bla-bla`, то все гаразд - продовжуйте встановлювати вашу систему. Певне наступним кроком після того, як під'єднаєте до мережі, має бути Підготовка дисків (https://wiki.gentoo.org/wiki/Handbook:AMD64/Installation/Disks/uk).

(Коли що, перервати пінго-видачу як і будь-що в терміналі Лінукса - Ctrl+C. Або додайти в пінгову команду опцію `ping -c 3`, де замість трьох можете поставити будь-яку цифру - стільки рядків і видасть пінґ.)

## Налаштувати ядро Лінукса для Wifi

Якщо ви ще не знайомі як конфігурувати ядро Лінукса, то Вікі Ґенту вас навчить. :)

Отже,

```bash
cd /usr/cd/linux
make menuconfig
```

До речі. Я конфіґурував ядро "вручну", однак десь бачив, що по дефолту genkernel (автоматична конфіґурація ядра) Wifi на налаштовує. Тож певне доведеться ручками.

### Підтримка бездротових мереж


### Драйвери устаткування

Драйвери рекомендовано встановити як модулі, щоби вони могли співпрацювати з пропрієтарними драйверами, вони ж firmware

There are four possible combinations for a module that needs fimware.
The module and firmware can both be in the kernel - that works
The module can be in /lib/modules and the firmware in /lib/firmware - that works too.
The other two combinations fail. https://forums.gentoo.org/viewtopic-p-7640156.html#7640156

Список драйверів, які вимагають firmware, можна знайти на Вікі Ґенту. https://wiki.gentoo.org/wiki/Wifi#Firmware

Мій драйвер ніби не вимагав пропрієтарщини, але я все одно встановив його як модуль про всяк випадок:



Також для WPA чи WPA2 ***конче треба*** активувати **AES cipher**:

 Also be sure to enable AES cipher support in the kernel if the wireless network uses WPA or WPA2 encryption.

## Необхідні мережеві інструменти

Дев'ятий і перд-перед-останній етап інсталяції Ґенту Лінукс (лінк) - встановлення необхідних пакетів. Отут будьте пильними, бо може бути потім тяжко завести машинку.

Що стосується мережевих пакетів, то ось:

**dhcpcd** - це треба виділити величезними літерами в Gentoo Handbook. Пакет, який сконфігурує під'єднання до мережі, зокрема IP-адресу, gateway і такий інший стаф.
**wpa_supplicant** - утиліта, якою ми вже користувалися під час інсталяції системи. Саме wpa_supplicant під'єднує вашу машину до Wifi роутера з протоколом WPA (який нині є звичним).

Це і все. Не ждали, хехех?

Нагадаю як установлювати (радше *долучати*) пакунки за допомогою **Portage** (лінк):

```bash
emerge -a dhcpcd wpa_supplicant
```
Другий важливий момент - **НЕ** встановлюйте `netifrc` за загальною порадою Посібника. Воно лише може запороти наше під'єднання через конфлікт керунків мережі.

## Налаштувати Wifi в готовій Gentoo

Перш за все, вітаю.

Ви встановили Ґенту! https://drama.kropyva.ch/Gentoo#.D0.9A.D0.BE.D1.80.D0.B8.D1.81.D1.82.D1.83.D0.B9.D1.81.D1.8F_Gentoo.21

По-друге, звісно треба якнайшвидше під'єднатися до мережі, бо без Інтернету наша дистра мало що може. :)

Насамперед пробуємо те саме, що робили під час інсталяції Gentoo.



### Автоматичний запуск Wifi на старті системи

https://wiki.gentoo.org/wiki/Network_management_using_DHCPCD
